#!/usr/bin/env pwsh

# Determine the directory of the current script.
$basedir = Split-Path $MyInvocation.MyCommand.Definition -Parent

# Default executable suffix is empty.
$exe = ""

# If running on Windows or with a PowerShell version earlier than 6,
# set the executable suffix to ".exe" to differentiate between Windows and Linux builds.
if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) {
    $exe = ".exe"
}

# Build the full path to the Node executable.
$nodePath = "$basedir/../node/bin/node$exe"

# Support pipeline input: if input is provided, pipe it to the Node executable along with any arguments.
if ($MyInvocation.ExpectingInput) {
    $input | & $nodePath $args
} else {
    & $nodePath $args
}

# Exit with the same exit code as the Node process.
exit $LASTEXITCODE

